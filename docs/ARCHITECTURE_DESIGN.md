# CRAFT æŠ€æœ¯æ¶æ„è®¾è®¡æ–‡æ¡£

> **CRAFT Runs Any Framework Technology**
> ç‰ˆæœ¬: 2.0.0 | æ—¥æœŸ: 2026-01-20

## ä¸€ã€é¡¹ç›®æ„¿æ™¯ä¸ç›®æ ‡

### 1.1 é¡¹ç›®å®šä½

CRAFT æ˜¯ä¸€ä¸ª **AI é©±åŠ¨çš„è‡ªåŠ¨åŒ– API é€‚é…å±‚ç”Ÿæˆç³»ç»Ÿ**ï¼Œæ—¨åœ¨é€šè¿‡é«˜åº¦è‡ªåŠ¨åŒ–çš„æ–¹å¼ï¼Œå¤§è§„æ¨¡ç”Ÿæˆè·¨å¹³å° API è½¬æ¥ä»£ç ï¼ˆå¦‚ Android API åˆ° HarmonyOS APIï¼‰ã€‚

### 1.2 æ ¸å¿ƒç›®æ ‡

| ç›®æ ‡ | æè¿° | è¡¡é‡æ ‡å‡† |
|------|------|---------|
| **è§„æ¨¡åŒ–** | æ”¯æŒ 30,000+ API çš„è‡ªåŠ¨åˆ†æä¸é€‚é… | API è¦†ç›–ç‡ > 90% |
| **è‡ªåŠ¨åŒ–** | æœ€å°åŒ–äººå·¥å¹²é¢„ï¼ŒAI é©±åŠ¨çš„ä»£ç ç”Ÿæˆ | äººå·¥ä»‹å…¥ç‡ < 10% |
| **é«˜è´¨é‡** | ç”Ÿæˆçš„ä»£ç ç¬¦åˆç”Ÿäº§æ ‡å‡† | è‡ªåŠ¨åŒ–æµ‹è¯•é€šè¿‡ç‡ > 95% |
| **é«˜æ€§èƒ½** | æä½çš„è¿è¡Œæ—¶å¼€é”€ | æ€§èƒ½æŸè€— < 5% |
| **å†…å­˜å®‰å…¨** | é›¶å†…å­˜æ³„æ¼ï¼Œé›¶æ•°æ®ç«äº‰ | Rust ç¼–è¯‘æ—¶ä¿è¯ |

### 1.3 è®¾è®¡åŸåˆ™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      CRAFT è®¾è®¡åŸåˆ™                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. AI First      - AI æ˜¯æ ¸å¿ƒç”Ÿäº§åŠ›ï¼Œäººæ˜¯å®¡æ ¸è€…                  â”‚
â”‚  2. Safety First  - å†…å­˜å®‰å…¨ã€ç±»å‹å®‰å…¨ã€å¹¶å‘å®‰å…¨                 â”‚
â”‚  3. Spec Driven   - åŸºäºå½¢å¼åŒ–è§„æ ¼çš„ä»£ç ç”Ÿæˆ                     â”‚
â”‚  4. Zero Cost     - é›¶æˆæœ¬æŠ½è±¡ï¼Œç¼–è¯‘æ—¶ä¼˜åŒ–                       â”‚
â”‚  5. Verifiable    - å¯éªŒè¯ã€å¯æµ‹è¯•ã€å¯è¿½æº¯                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 ä¸ºä»€ä¹ˆé€‰æ‹© Rust

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Rust æŠ€æœ¯ä¼˜åŠ¿                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ”’ å†…å­˜å®‰å…¨                                                     â”‚
â”‚  â”œâ”€â”€ æ‰€æœ‰æƒç³»ç»Ÿåœ¨ç¼–è¯‘æ—¶é˜²æ­¢å†…å­˜æ³„æ¼                              â”‚
â”‚  â”œâ”€â”€ å€Ÿç”¨æ£€æŸ¥å™¨é˜²æ­¢æ‚¬å‚æŒ‡é’ˆå’Œæ•°æ®ç«äº‰                            â”‚
â”‚  â””â”€â”€ æ— éœ€åƒåœ¾å›æ”¶ï¼Œç¡®å®šæ€§å†…å­˜ç®¡ç†                                â”‚
â”‚                                                                 â”‚
â”‚  âš¡ æè‡´æ€§èƒ½                                                     â”‚
â”‚  â”œâ”€â”€ é›¶æˆæœ¬æŠ½è±¡ï¼Œä¸ C/C++ åŒçº§æ€§èƒ½                               â”‚
â”‚  â”œâ”€â”€ æ— è¿è¡Œæ—¶å¼€é”€ï¼Œé€‚åˆç³»ç»Ÿçº§ä»£ç                                 â”‚
â”‚  â””â”€â”€ LLVM åç«¯ï¼Œé«˜åº¦ä¼˜åŒ–çš„æœºå™¨ç                                  â”‚
â”‚                                                                 â”‚
â”‚  âœ… å¯éªŒè¯æ€§                                                     â”‚
â”‚  â”œâ”€â”€ å¼ºç±»å‹ç³»ç»Ÿåœ¨ç¼–è¯‘æ—¶æ•è·å¤§é‡é”™è¯¯                              â”‚
â”‚  â”œâ”€â”€ æ¨¡å¼åŒ¹é…ç¡®ä¿ç©·å°½æ€§æ£€æŸ¥                                      â”‚
â”‚  â”œâ”€â”€ Result/Option ç±»å‹å¼ºåˆ¶é”™è¯¯å¤„ç†                              â”‚
â”‚  â””â”€â”€ ä¸°å¯Œçš„æµ‹è¯•æ¡†æ¶å’Œæ–‡æ¡£æµ‹è¯•                                    â”‚
â”‚                                                                 â”‚
â”‚  ğŸ”§ å·¥å…·é“¾                                                       â”‚
â”‚  â”œâ”€â”€ Cargo: ä¼˜ç§€çš„åŒ…ç®¡ç†å’Œæ„å»ºç³»ç»Ÿ                               â”‚
â”‚  â”œâ”€â”€ rustfmt/clippy: ä»£ç æ ¼å¼åŒ–å’Œé™æ€åˆ†æ                        â”‚
â”‚  â””â”€â”€ è·¨å¹³å°ç¼–è¯‘æ”¯æŒ                                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€ç³»ç»Ÿæ€»ä½“æ¶æ„

### 2.1 æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       CRAFT System Architecture (Rust)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     Layer 1: Input Sources                       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ Android SDK  â”‚  â”‚ HarmonyOS SDKâ”‚  â”‚ API Documentation    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ Source Code  â”‚  â”‚ Source Code  â”‚  â”‚ (AOSP, OpenHarmony)  â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                     â”‚
â”‚                                    â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                Layer 2: Analysis Engine (Rust)                   â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ tree-sitter  â”‚  â”‚ Semantic     â”‚  â”‚ Compatibility        â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ Parser       â”‚  â”‚ Analyzer     â”‚  â”‚ Matcher              â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                     â”‚
â”‚                                    â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                Layer 3: Knowledge Base (Rust + SQLite)           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ API Specs    â”‚  â”‚ Mapping      â”‚  â”‚ Pattern              â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ (serde)      â”‚  â”‚ Rules DB     â”‚  â”‚ Library              â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                     â”‚
â”‚                                    â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚               Layer 4: AI Generation Engine (Rust)               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ Claude API   â”‚  â”‚ Code         â”‚  â”‚ Template             â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ Client       â”‚  â”‚ Generator    â”‚  â”‚ Engine (Tera)        â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                     â”‚
â”‚                                    â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                Layer 5: Quality Assurance (Rust)                 â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ Test         â”‚  â”‚ Validator    â”‚  â”‚ Benchmark            â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ Generator    â”‚  â”‚ Engine       â”‚  â”‚ Suite                â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                    â”‚                                     â”‚
â”‚                                    â–¼                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                     Layer 6: Output Artifacts                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ Shim Layer   â”‚  â”‚ Native       â”‚  â”‚ Documentation        â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ Libraries    â”‚  â”‚ Bridges      â”‚  â”‚ & Reports            â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ•°æ®æµæ¶æ„

```
Android API Spec                    HarmonyOS API Spec
      â”‚                                    â”‚
      â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ tree-sitter â”‚                    â”‚ tree-sitter â”‚
â”‚ Java Parser â”‚                    â”‚ ArkTS Parserâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                  â”‚
       â–¼                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Semantic Mapping Engine (Rust)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Android API  â†â”€â”€mappingâ”€â”€â†’ Harmony API  â”‚    â”‚
â”‚  â”‚  Strongly typed with serde + validation  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   AI Code Generator     â”‚
        â”‚   (reqwest + Claude)    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â–¼           â–¼           â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Adapter â”‚ â”‚ Bridge  â”‚ â”‚  Test   â”‚
   â”‚  Code   â”‚ â”‚  Code   â”‚ â”‚  Code   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€æ ¸å¿ƒç»„ä»¶è¯¦ç»†è®¾è®¡

### 3.1 API åˆ†æå¼•æ“ (Analysis Engine)

#### 3.1.1 åŠŸèƒ½èŒè´£

```rust
/// API åˆ†æå¼•æ“
/// è´Ÿè´£è§£æå’Œåˆ†æ SDK æºç ï¼Œæå– API è§„æ ¼
pub struct ApiAnalyzer {
    java_parser: TreeSitterParser,
    arkts_parser: TreeSitterParser,
    semantic_engine: SemanticEngine,
}

impl ApiAnalyzer {
    /// è§£æ SDK æºç ï¼Œæå–æ‰€æœ‰å…¬å¼€ API
    pub fn parse_sdk(&self, sdk_path: &Path) -> Result<ApiRepository, AnalyzerError> {
        let files = self.discover_source_files(sdk_path)?;
        let apis = files
            .par_iter()  // ä½¿ç”¨ rayon å¹¶è¡Œå¤„ç†
            .map(|file| self.parse_file(file))
            .collect::<Result<Vec<_>, _>>()?;

        Ok(ApiRepository::from_specs(apis))
    }

    /// ä½¿ç”¨ AI åˆ†æ API çš„è¯­ä¹‰å«ä¹‰
    pub async fn analyze_semantics(&self, api: &ApiSpec) -> Result<SemanticInfo, AnalyzerError> {
        self.semantic_engine.analyze(api).await
    }

    /// æ„å»º API ä¾èµ–å…³ç³»å›¾
    pub fn build_dependency_graph(&self, apis: &[ApiSpec]) -> DependencyGraph {
        DependencyGraph::build_from(apis)
    }
}
```

#### 3.1.2 API è§„æ ¼å®šä¹‰ (Type-Safe)

```rust
use serde::{Deserialize, Serialize};

/// API è§„æ ¼å®šä¹‰ - å¼ºç±»å‹ã€å¯åºåˆ—åŒ–
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct ApiSpec {
    pub platform: Platform,
    pub version: String,
    pub package: String,
    pub class_name: String,
    pub methods: Vec<MethodSpec>,
    pub fields: Vec<FieldSpec>,
    #[serde(default)]
    pub annotations: Vec<String>,
    #[serde(default)]
    pub semantic_tags: Vec<SemanticTag>,
}

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct MethodSpec {
    pub name: String,
    pub signature: String,
    pub params: Vec<ParamSpec>,
    pub return_type: TypeSpec,
    pub throws: Vec<String>,
    pub visibility: Visibility,
    #[serde(default)]
    pub is_static: bool,
    #[serde(default)]
    pub is_deprecated: bool,
    pub since: Option<String>,
}

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct ParamSpec {
    pub name: String,
    #[serde(rename = "type")]
    pub param_type: TypeSpec,
    #[serde(default)]
    pub nullable: bool,
    pub description: Option<String>,
}

#[derive(Debug, Clone, Copy, Serialize, Deserialize, PartialEq, Eq)]
#[serde(rename_all = "lowercase")]
pub enum Platform {
    Android,
    Harmony,
}

#[derive(Debug, Clone, Copy, Serialize, Deserialize, PartialEq, Eq)]
#[serde(rename_all = "lowercase")]
pub enum Visibility {
    Public,
    Protected,
    Private,
    Package,
}
```

#### 3.1.3 ä½¿ç”¨ tree-sitter è¿›è¡Œé«˜æ€§èƒ½è§£æ

```rust
use tree_sitter::{Parser, Language};

pub struct TreeSitterParser {
    parser: Parser,
    language: Language,
}

impl TreeSitterParser {
    pub fn new_java() -> Result<Self, ParserError> {
        let mut parser = Parser::new();
        let language = tree_sitter_java::language();
        parser.set_language(language)?;
        Ok(Self { parser, language })
    }

    pub fn parse_file(&mut self, source: &str) -> Result<ParsedAst, ParserError> {
        let tree = self.parser
            .parse(source, None)
            .ok_or(ParserError::ParseFailed)?;

        let root = tree.root_node();
        self.extract_api_specs(root, source)
    }

    fn extract_api_specs(&self, node: tree_sitter::Node, source: &str) -> Result<ParsedAst, ParserError> {
        // é€’å½’éå† ASTï¼Œæå–ç±»ã€æ–¹æ³•ã€å­—æ®µå®šä¹‰
        // ...
    }
}
```

### 3.2 è¯­ä¹‰æ˜ å°„å¼•æ“ (Semantic Mapping Engine)

#### 3.2.1 æ˜ å°„è§„åˆ™å®šä¹‰

```rust
/// æ˜ å°„è§„åˆ™ - å¼ºç±»å‹å®šä¹‰
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct MappingRule {
    pub id: String,
    pub source: ApiReference,
    pub target: ApiReference,
    pub mapping_type: MappingType,
    pub confidence: f64,
    pub transformations: Vec<Transformation>,
    #[serde(default)]
    pub requires_bridge: bool,
    pub notes: Option<String>,
}

#[derive(Debug, Clone, Copy, Serialize, Deserialize, PartialEq, Eq)]
#[serde(rename_all = "snake_case")]
pub enum MappingType {
    /// 1:1 ç›´æ¥æ˜ å°„
    Direct,
    /// è¯­ä¹‰ç­‰ä»·æ˜ å°„
    Semantic,
    /// éœ€è¦å‚æ•°è½¬æ¢
    Transform,
    /// éœ€è¦æ¡¥æ¥ä»£ç 
    Bridge,
    /// éœ€è¦æ¨¡æ‹Ÿå®ç°
    Shim,
    /// æ— æ³•æ˜ å°„
    Unsupported,
}

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct Transformation {
    pub kind: TransformKind,
    pub source_param: Option<String>,
    pub target_param: Option<String>,
    pub expression: Option<String>,
}

#[derive(Debug, Clone, Copy, Serialize, Deserialize)]
#[serde(rename_all = "snake_case")]
pub enum TransformKind {
    TypeConversion,
    ParameterReorder,
    ParameterMerge,
    ParameterSplit,
    DefaultValue,
    CustomCode,
}
```

#### 3.2.2 æ˜ å°„å¼•æ“å®ç°

```rust
pub struct MappingEngine {
    rules: RwLock<HashMap<String, MappingRule>>,
    ai_client: Arc<ClaudeClient>,
}

impl MappingEngine {
    /// æŸ¥æ‰¾æœ€ä½³æ˜ å°„
    pub async fn find_mapping(
        &self,
        source_api: &ApiSpec,
        target_apis: &[ApiSpec],
    ) -> Result<Option<MappingRule>, MappingError> {
        // 1. å…ˆæ£€æŸ¥å·²çŸ¥è§„åˆ™
        if let Some(rule) = self.find_known_mapping(source_api) {
            return Ok(Some(rule));
        }

        // 2. å°è¯•åç§°ç›¸ä¼¼åº¦åŒ¹é…
        if let Some(rule) = self.find_by_similarity(source_api, target_apis) {
            if rule.confidence > 0.8 {
                return Ok(Some(rule));
            }
        }

        // 3. ä½¿ç”¨ AI è¿›è¡Œè¯­ä¹‰åŒ¹é…
        self.ai_semantic_match(source_api, target_apis).await
    }

    /// æ‰¹é‡æ˜ å°„ - ä½¿ç”¨ rayon å¹¶è¡Œå¤„ç†
    pub async fn batch_map(
        &self,
        sources: &[ApiSpec],
        targets: &[ApiSpec],
    ) -> Vec<Result<MappingRule, MappingError>> {
        // å¯¹äºç®€å•æ˜ å°„ä½¿ç”¨å¹¶è¡Œå¤„ç†
        let (simple, complex): (Vec<_>, Vec<_>) = sources
            .iter()
            .partition(|api| self.is_simple_mapping(api));

        let simple_results: Vec<_> = simple
            .par_iter()
            .map(|api| self.find_known_mapping(api).ok_or(MappingError::NotFound))
            .collect();

        // å¯¹äºå¤æ‚æ˜ å°„ä½¿ç”¨ AIï¼ˆå¸¦é€Ÿç‡é™åˆ¶ï¼‰
        let complex_results = self.batch_ai_map(&complex, targets).await;

        // åˆå¹¶ç»“æœ
        [simple_results, complex_results].concat()
    }
}
```

### 3.3 AI ä»£ç ç”Ÿæˆå¼•æ“

#### 3.3.1 Claude API å®¢æˆ·ç«¯

```rust
use reqwest::Client;
use serde_json::json;

pub struct ClaudeClient {
    client: Client,
    api_key: String,
    model: String,
    rate_limiter: RateLimiter,
}

impl ClaudeClient {
    pub fn new(api_key: String) -> Self {
        Self {
            client: Client::new(),
            api_key,
            model: "claude-opus-4-5-20251101".to_string(),
            rate_limiter: RateLimiter::new(50), // 50 RPM
        }
    }

    pub async fn generate_adapter(
        &self,
        context: &AdapterContext,
    ) -> Result<GeneratedCode, AiError> {
        self.rate_limiter.acquire().await;

        let prompt = self.build_adapter_prompt(context);

        let response = self.client
            .post("https://api.anthropic.com/v1/messages")
            .header("x-api-key", &self.api_key)
            .header("anthropic-version", "2023-06-01")
            .json(&json!({
                "model": self.model,
                "max_tokens": 4096,
                "messages": [{"role": "user", "content": prompt}]
            }))
            .send()
            .await?;

        let result: ApiResponse = response.json().await?;
        self.parse_generated_code(&result)
    }
}
```

#### 3.3.2 ä»£ç ç”Ÿæˆå™¨

```rust
use tera::{Tera, Context};

pub struct CodeGenerator {
    templates: Tera,
    ai_client: Arc<ClaudeClient>,
}

impl CodeGenerator {
    pub fn new(template_dir: &Path) -> Result<Self, GeneratorError> {
        let templates = Tera::new(
            template_dir.join("**/*.tera").to_str().unwrap()
        )?;

        Ok(Self {
            templates,
            ai_client: Arc::new(ClaudeClient::new(
                std::env::var("ANTHROPIC_API_KEY")?
            )),
        })
    }

    /// ç”Ÿæˆé€‚é…å™¨ä»£ç 
    pub async fn generate(
        &self,
        mapping: &MappingRule,
        source_api: &ApiSpec,
        target_api: &ApiSpec,
    ) -> Result<GeneratedAdapter, GeneratorError> {
        match mapping.mapping_type {
            MappingType::Direct => self.generate_direct_adapter(mapping, source_api, target_api),
            MappingType::Semantic | MappingType::Transform => {
                self.generate_transform_adapter(mapping, source_api, target_api)
            }
            MappingType::Bridge | MappingType::Shim => {
                self.generate_with_ai(mapping, source_api, target_api).await
            }
            MappingType::Unsupported => Err(GeneratorError::Unsupported),
        }
    }

    fn generate_direct_adapter(
        &self,
        mapping: &MappingRule,
        source: &ApiSpec,
        target: &ApiSpec,
    ) -> Result<GeneratedAdapter, GeneratorError> {
        let mut context = Context::new();
        context.insert("source", source);
        context.insert("target", target);
        context.insert("mapping", mapping);
        context.insert("timestamp", &chrono::Utc::now().to_rfc3339());

        let code = self.templates.render("adapter_java.tera", &context)?;

        Ok(GeneratedAdapter {
            code,
            confidence: mapping.confidence,
            requires_review: mapping.confidence < 0.9,
        })
    }
}
```

### 3.4 æµ‹è¯•ç”Ÿæˆæ¡†æ¶

```rust
pub struct TestGenerator {
    templates: Tera,
}

impl TestGenerator {
    /// ç”Ÿæˆå•å…ƒæµ‹è¯•
    pub fn generate_unit_tests(
        &self,
        adapter: &GeneratedAdapter,
        source_api: &ApiSpec,
    ) -> Result<GeneratedTests, TestGenError> {
        let test_cases: Vec<TestCase> = source_api
            .methods
            .iter()
            .flat_map(|method| self.generate_method_tests(method))
            .collect();

        let mut context = Context::new();
        context.insert("adapter", adapter);
        context.insert("test_cases", &test_cases);

        let code = self.templates.render("test_java.tera", &context)?;

        Ok(GeneratedTests { code, test_cases })
    }

    fn generate_method_tests(&self, method: &MethodSpec) -> Vec<TestCase> {
        let mut tests = vec![
            // åŸºæœ¬åŠŸèƒ½æµ‹è¯•
            TestCase::new(&format!("test_{}_basic", method.name)),
        ];

        // å‚æ•°è¾¹ç•Œæµ‹è¯•
        for param in &method.params {
            if param.nullable {
                tests.push(TestCase::new(&format!(
                    "test_{}_{}_null",
                    method.name, param.name
                )));
            }
        }

        // å¼‚å¸¸æµ‹è¯•
        for exception in &method.throws {
            tests.push(TestCase::new(&format!(
                "test_{}_throws_{}",
                method.name,
                exception.split('.').last().unwrap_or(exception)
            )));
        }

        tests
    }
}
```

---

## å››ã€å¹¶å‘ä¸æ€§èƒ½è®¾è®¡

### 4.1 å¹¶å‘æ¨¡å‹

```rust
use tokio::sync::{Semaphore, RwLock};
use rayon::prelude::*;

pub struct BatchProcessor {
    /// CPU å¯†é›†å‹ä»»åŠ¡ä½¿ç”¨ rayon çº¿ç¨‹æ± 
    cpu_pool: rayon::ThreadPool,
    /// IO å¯†é›†å‹ä»»åŠ¡ä½¿ç”¨ tokio
    io_semaphore: Semaphore,
    /// AI API é€Ÿç‡é™åˆ¶
    ai_rate_limiter: RateLimiter,
}

impl BatchProcessor {
    pub async fn process_batch(
        &self,
        apis: Vec<ApiSpec>,
    ) -> Vec<Result<GeneratedAdapter, ProcessError>> {
        // åˆ†ç±»: CPU å¯†é›†å‹ vs IO å¯†é›†å‹
        let (cpu_bound, io_bound): (Vec<_>, Vec<_>) = apis
            .into_iter()
            .partition(|api| self.is_cpu_bound(api));

        // CPU å¯†é›†å‹: ä½¿ç”¨ rayon å¹¶è¡Œå¤„ç†
        let cpu_results: Vec<_> = cpu_bound
            .par_iter()
            .map(|api| self.process_cpu_bound(api))
            .collect();

        // IO å¯†é›†å‹: ä½¿ç”¨ tokio å¼‚æ­¥å¤„ç†
        let io_results = futures::future::join_all(
            io_bound.iter().map(|api| self.process_io_bound(api))
        ).await;

        [cpu_results, io_results].concat()
    }
}

/// é€Ÿç‡é™åˆ¶å™¨ - ä»¤ç‰Œæ¡¶ç®—æ³•
pub struct RateLimiter {
    tokens: AtomicU32,
    max_tokens: u32,
    refill_interval: Duration,
}

impl RateLimiter {
    pub async fn acquire(&self) {
        loop {
            let current = self.tokens.load(Ordering::Relaxed);
            if current > 0 {
                if self.tokens
                    .compare_exchange(current, current - 1, Ordering::SeqCst, Ordering::Relaxed)
                    .is_ok()
                {
                    return;
                }
            }
            tokio::time::sleep(Duration::from_millis(100)).await;
        }
    }
}
```

### 4.2 å†…å­˜ç®¡ç†

```rust
/// ä½¿ç”¨ Arena åˆ†é…å™¨ä¼˜åŒ–å¤§é‡å°å¯¹è±¡åˆ†é…
use bumpalo::Bump;

pub struct ParsingContext<'a> {
    arena: &'a Bump,
    source: &'a str,
}

impl<'a> ParsingContext<'a> {
    /// åœ¨ Arena ä¸­åˆ†é…å­—ç¬¦ä¸²ï¼Œé¿å…é¢‘ç¹å †åˆ†é…
    pub fn intern_string(&self, s: &str) -> &'a str {
        self.arena.alloc_str(s)
    }
}

/// ä½¿ç”¨ Cow é¿å…ä¸å¿…è¦çš„å…‹éš†
use std::borrow::Cow;

pub struct ApiReference<'a> {
    pub package: Cow<'a, str>,
    pub class: Cow<'a, str>,
    pub method: Option<Cow<'a, str>>,
}
```

---

## äº”ã€é¡¹ç›®ç›®å½•ç»“æ„

```
CRAFT/
â”œâ”€â”€ Cargo.toml                      # å·¥ä½œç©ºé—´é…ç½®
â”œâ”€â”€ Cargo.lock                      # ä¾èµ–é”å®š
â”œâ”€â”€ README.md                       # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ CLAUDE.md                       # Claude Code å¼€å‘è§„èŒƒ
â”‚
â”œâ”€â”€ crates/                         # Rust crates
â”‚   â”œâ”€â”€ craft-core/                 # æ ¸å¿ƒæ•°æ®ç»“æ„
â”‚   â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs
â”‚   â”‚       â”œâ”€â”€ api_spec.rs         # API è§„æ ¼å®šä¹‰
â”‚   â”‚       â”œâ”€â”€ mapping.rs          # æ˜ å°„è§„åˆ™å®šä¹‰
â”‚   â”‚       â””â”€â”€ error.rs            # é”™è¯¯ç±»å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ craft-parser/               # SDK è§£æå™¨
â”‚   â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs
â”‚   â”‚       â”œâ”€â”€ java.rs             # Java/Kotlin è§£æ
â”‚   â”‚       â”œâ”€â”€ arkts.rs            # ArkTS è§£æ
â”‚   â”‚       â””â”€â”€ tree_sitter.rs      # tree-sitter é›†æˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ craft-analyzer/             # è¯­ä¹‰åˆ†æå™¨
â”‚   â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs
â”‚   â”‚       â”œâ”€â”€ semantic.rs         # è¯­ä¹‰åˆ†æ
â”‚   â”‚       â””â”€â”€ matcher.rs          # åŒ¹é…ç®—æ³•
â”‚   â”‚
â”‚   â”œâ”€â”€ craft-generator/            # ä»£ç ç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs
â”‚   â”‚       â”œâ”€â”€ adapter.rs          # é€‚é…å™¨ç”Ÿæˆ
â”‚   â”‚       â”œâ”€â”€ test.rs             # æµ‹è¯•ç”Ÿæˆ
â”‚   â”‚       â””â”€â”€ template.rs         # æ¨¡æ¿å¼•æ“
â”‚   â”‚
â”‚   â”œâ”€â”€ craft-ai/                   # AI é›†æˆ
â”‚   â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs
â”‚   â”‚       â”œâ”€â”€ claude.rs           # Claude API å®¢æˆ·ç«¯
â”‚   â”‚       â””â”€â”€ prompt.rs           # æç¤ºè¯ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ craft-pipeline/             # è‡ªåŠ¨åŒ–æµæ°´çº¿
â”‚   â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â”œâ”€â”€ lib.rs
â”‚   â”‚       â”œâ”€â”€ orchestrator.rs     # æµç¨‹ç¼–æ’
â”‚   â”‚       â”œâ”€â”€ batch.rs            # æ‰¹é‡å¤„ç†
â”‚   â”‚       â””â”€â”€ incremental.rs      # å¢é‡æ›´æ–°
â”‚   â”‚
â”‚   â””â”€â”€ craft-cli/                  # å‘½ä»¤è¡Œå·¥å…·
â”‚       â”œâ”€â”€ Cargo.toml
â”‚       â””â”€â”€ src/
â”‚           â””â”€â”€ main.rs
â”‚
â”œâ”€â”€ docs/                           # è®¾è®¡æ–‡æ¡£
â”‚   â”œâ”€â”€ ARCHITECTURE_DESIGN.md      # æœ¬æ–‡æ¡£
â”‚   â”œâ”€â”€ FEASIBILITY_ANALYSIS.md     # å¯è¡Œæ€§åˆ†æ
â”‚   â””â”€â”€ API_MAPPING_SPEC.md         # API æ˜ å°„è§„æ ¼
â”‚
â”œâ”€â”€ templates/                      # ä»£ç æ¨¡æ¿ (Tera)
â”‚   â”œâ”€â”€ adapter_java.tera
â”‚   â”œâ”€â”€ adapter_kotlin.tera
â”‚   â”œâ”€â”€ test_java.tera
â”‚   â””â”€â”€ prompts/                    # AI æç¤ºè¯
â”‚       â””â”€â”€ generate_adapter.md
â”‚
â”œâ”€â”€ specs/                          # API è§„æ ¼ (YAML/JSON)
â”‚   â”œâ”€â”€ android/
â”‚   â””â”€â”€ harmony/
â”‚
â”œâ”€â”€ configs/                        # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ craft_config.toml           # ä¸»é…ç½®
â”‚   â””â”€â”€ mapping_rules.yaml          # æ˜ å°„è§„åˆ™
â”‚
â”œâ”€â”€ tests/                          # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ integration/
â”‚   â””â”€â”€ fixtures/
â”‚
â””â”€â”€ output/                         # è¾“å‡ºäº§ç‰©
    â”œâ”€â”€ adapters/
    â”œâ”€â”€ reports/
    â””â”€â”€ benchmarks/
```

---

## å…­ã€å…³é”®æŠ€æœ¯é€‰å‹

### 6.1 æŠ€æœ¯æ ˆ

| å±‚æ¬¡ | æŠ€æœ¯é€‰å‹ | ç†ç”± |
|------|---------|------|
| **è¯­è¨€** | Rust 1.75+ | å†…å­˜å®‰å…¨ã€é«˜æ€§èƒ½ã€å¯éªŒè¯æ€§ |
| **å¼‚æ­¥è¿è¡Œæ—¶** | Tokio | é«˜æ€§èƒ½å¼‚æ­¥ IO |
| **å¹¶è¡Œè®¡ç®—** | Rayon | æ•°æ®å¹¶è¡Œå¤„ç† |
| **è§£æå™¨** | tree-sitter | å¢é‡è§£æã€å¤šè¯­è¨€æ”¯æŒ |
| **åºåˆ—åŒ–** | serde + serde_json/yaml | é«˜æ€§èƒ½ã€ç±»å‹å®‰å…¨ |
| **æ¨¡æ¿å¼•æ“** | Tera | Jinja2 å…¼å®¹ã€Rust åŸç”Ÿ |
| **HTTP å®¢æˆ·ç«¯** | reqwest | å¼‚æ­¥ã€è¿æ¥æ±  |
| **æ•°æ®åº“** | SQLite (rusqlite) | è½»é‡çº§ã€åµŒå…¥å¼ |
| **CLI** | clap | å£°æ˜å¼å‘½ä»¤è¡Œè§£æ |
| **æ—¥å¿—** | tracing | ç»“æ„åŒ–æ—¥å¿—ã€æ€§èƒ½åˆ†æ |
| **é”™è¯¯å¤„ç†** | thiserror + anyhow | ç±»å‹å®‰å…¨çš„é”™è¯¯å¤„ç† |

### 6.2 Cargo.toml å·¥ä½œç©ºé—´é…ç½®

```toml
[workspace]
resolver = "2"
members = [
    "crates/craft-core",
    "crates/craft-parser",
    "crates/craft-analyzer",
    "crates/craft-generator",
    "crates/craft-ai",
    "crates/craft-pipeline",
    "crates/craft-cli",
]

[workspace.package]
version = "0.1.0"
edition = "2021"
rust-version = "1.75"
license = "Apache-2.0"
repository = "https://github.com/lisihao/CRAFT"

[workspace.dependencies]
# å¼‚æ­¥è¿è¡Œæ—¶
tokio = { version = "1.35", features = ["full"] }
futures = "0.3"

# å¹¶è¡Œè®¡ç®—
rayon = "1.8"

# åºåˆ—åŒ–
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
serde_yaml = "0.9"
toml = "0.8"

# è§£æ
tree-sitter = "0.20"
tree-sitter-java = "0.20"

# æ¨¡æ¿
tera = "1.19"

# HTTP
reqwest = { version = "0.11", features = ["json"] }

# æ•°æ®åº“
rusqlite = { version = "0.30", features = ["bundled"] }

# CLI
clap = { version = "4.4", features = ["derive"] }

# æ—¥å¿—
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }

# é”™è¯¯å¤„ç†
thiserror = "1.0"
anyhow = "1.0"

# å·¥å…·
chrono = { version = "0.4", features = ["serde"] }
uuid = { version = "1.6", features = ["v4", "serde"] }
```

### 6.3 é”™è¯¯å¤„ç†è®¾è®¡

```rust
use thiserror::Error;

#[derive(Error, Debug)]
pub enum CraftError {
    #[error("Parse error: {0}")]
    Parse(#[from] ParseError),

    #[error("Mapping error: {0}")]
    Mapping(#[from] MappingError),

    #[error("Generation error: {0}")]
    Generation(#[from] GeneratorError),

    #[error("AI error: {0}")]
    Ai(#[from] AiError),

    #[error("IO error: {0}")]
    Io(#[from] std::io::Error),
}

#[derive(Error, Debug)]
pub enum ParseError {
    #[error("Failed to parse file: {path}")]
    FileParseFailed { path: PathBuf },

    #[error("Invalid syntax at line {line}, column {column}")]
    InvalidSyntax { line: usize, column: usize },

    #[error("Unsupported language: {0}")]
    UnsupportedLanguage(String),
}

// ä½¿ç”¨ Result ç±»å‹åˆ«åç®€åŒ–
pub type Result<T> = std::result::Result<T, CraftError>;
```

---

## ä¸ƒã€å®æ–½è·¯çº¿å›¾

### Phase 1: åŸºç¡€è®¾æ–½ (Foundation)
- [ ] æ­å»º Cargo workspace
- [ ] å®ç° craft-core æ ¸å¿ƒæ•°æ®ç»“æ„
- [ ] é›†æˆ tree-sitter è§£æå™¨
- [ ] å»ºç«‹åŸºç¡€ CLI æ¡†æ¶

### Phase 2: è§£æä¸åˆ†æ (Parser & Analyzer)
- [ ] å®ç° Java/Kotlin è§£æå™¨
- [ ] å®ç° ArkTS è§£æå™¨
- [ ] å»ºç«‹ API è§„æ ¼æ•°æ®åº“
- [ ] å®ç°åŸºç¡€è¯­ä¹‰åˆ†æ

### Phase 3: AI é›†æˆ (AI Integration)
- [ ] é›†æˆ Claude API
- [ ] å®ç°æç¤ºè¯æ¨¡æ¿ç³»ç»Ÿ
- [ ] å»ºç«‹é€Ÿç‡é™åˆ¶å’Œé‡è¯•æœºåˆ¶
- [ ] å®ç° AI è¾…åŠ©æ˜ å°„

### Phase 4: ä»£ç ç”Ÿæˆ (Code Generation)
- [ ] å®ç° Tera æ¨¡æ¿ç³»ç»Ÿ
- [ ] å®ç°é€‚é…å™¨ç”Ÿæˆå™¨
- [ ] å®ç°æµ‹è¯•ç”Ÿæˆå™¨
- [ ] å»ºç«‹è´¨é‡éªŒè¯æµç¨‹

### Phase 5: æµæ°´çº¿ (Pipeline)
- [ ] å®ç°æ‰¹é‡å¤„ç†å™¨
- [ ] å®ç°å¢é‡æ›´æ–°
- [ ] å»ºç«‹ CI/CD æµç¨‹
- [ ] æ€§èƒ½ä¼˜åŒ–å’ŒåŸºå‡†æµ‹è¯•

---

## å…«ã€æ€§èƒ½ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹é‡æ–¹å¼ |
|------|------|---------|
| è§£æé€Ÿåº¦ | > 10,000 files/sec | å•çº¿ç¨‹è§£æååé‡ |
| æ‰¹é‡æ˜ å°„ | > 1,000 APIs/sec | å« AI è°ƒç”¨çš„ç«¯åˆ°ç«¯ |
| å†…å­˜ä½¿ç”¨ | < 500MB | å¤„ç† 30,000 API æ—¶ |
| ç”Ÿæˆä»£ç æ€§èƒ½ | < 5% overhead | vs æ‰‹å†™é€‚é…å™¨ |
| ç¼–è¯‘æ—¶é—´ | < 30s (release) | å®Œæ•´é¡¹ç›®ç¼–è¯‘ |

---

## ä¹ã€å®‰å…¨æ€§ä¿è¯

```rust
// Rust ç¼–è¯‘æ—¶ä¿è¯
// âœ… å†…å­˜å®‰å…¨ - æ‰€æœ‰æƒç³»ç»Ÿ
// âœ… çº¿ç¨‹å®‰å…¨ - Send/Sync traits
// âœ… ç©ºæŒ‡é’ˆå®‰å…¨ - Option ç±»å‹
// âœ… é”™è¯¯å¤„ç† - Result ç±»å‹

// ç¤ºä¾‹: å¹¶å‘å®‰å…¨çš„ç¼“å­˜
use std::sync::Arc;
use tokio::sync::RwLock;

pub struct SafeCache<K, V> {
    inner: Arc<RwLock<HashMap<K, V>>>,
}

impl<K: Eq + Hash, V: Clone> SafeCache<K, V> {
    pub async fn get(&self, key: &K) -> Option<V> {
        self.inner.read().await.get(key).cloned()
    }

    pub async fn insert(&self, key: K, value: V) {
        self.inner.write().await.insert(key, value);
    }
}
// ç¼–è¯‘å™¨ä¿è¯: æ— æ•°æ®ç«äº‰ï¼Œæ— æ­»é”é£é™©
```

---

*æ–‡æ¡£ç‰ˆæœ¬: 2.0.0*
*æŠ€æœ¯æ ˆ: Rust*
*æœ€åæ›´æ–°: 2026-01-20*
*ä½œè€…: CRAFT Team (AI-assisted)*
